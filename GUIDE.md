# DODAM 사용 설명서

## 목차

1. [서비스 소개](#서비스-소개)
2. [회원가입](#회원가입)
3. [로그인](#로그인)
4. [피해자 사용법](#피해자-사용법)
   - [약속 코드 설정](#약속-코드-설정)
   - [보호자 초대](#보호자-초대)
   - [긴급 상황 시 사용법](#긴급-상황-시-사용법)
5. [보호자 사용법](#보호자-사용법)
   - [초대 수락](#초대-수락)
   - [대시보드](#대시보드)
   - [긴급 채팅](#긴급-채팅)
6. [주요 기능 상세](#주요-기능-상세)
7. [자주 묻는 질문](#자주-묻는-질문)

---

## 서비스 소개

DODAM(도담)은 위기 상황에서 피해자와 보호자를 연결하는 긴급 소통 플랫폼입니다.

핵심 특징은 **검색 엔진으로 위장된 긴급 진입 시스템**입니다. 가해자가 옆에서 지켜보고 있는 상황에서도, 피해자가 평범한 검색을 하는 것처럼 보이면서 보호자에게 긴급 알림을 보내고 채팅을 시작할 수 있습니다.

### 작동 원리

```
피해자가 검색창에 약속 코드 입력
        ↓
  코드가 맞으면 → 보안 질문 표시
  코드가 틀리면 → 일반 검색 결과 표시 (위장)
        ↓
  보안 질문 정답 → 긴급 채팅방 생성 + 보호자 알림
  보안 질문 오답 → 일반 검색 결과 표시 (위장)
```

외부에서 보면 **평범한 구글 검색**처럼 보이지만, 실제로는 보호자와 연결되어 있습니다.

---

## 회원가입

### 피해자 회원가입

1. 상단 메뉴에서 **Sign up** 클릭
2. **Step 1**: 역할 선택에서 **피해자** 선택, 이메일/비밀번호 입력
3. **Step 2**: 이름, 생년월일, 전화번호 입력
4. **Step 3**: 보호자 정보 입력 (선택사항, 나중에 설정 가능)
5. **완료** 클릭

### 보호자 회원가입

1. 상단 메뉴에서 **Sign up** 클릭
2. **Step 1**: 역할 선택에서 **보호자** 선택, 이메일/비밀번호 입력
3. **Step 2**: 이름, 생년월일, 전화번호 입력
4. **완료** 클릭

---

## 로그인

1. 상단 메뉴에서 **Log In** 클릭
2. 가입한 이메일과 비밀번호 입력
3. **로그인** 클릭
4. 역할에 따라 자동 이동:
   - 피해자 → 검색 페이지 (`/search`)
   - 보호자 → 대시보드 (`/guardian`)

---

## 피해자 사용법

### 약속 코드 설정

긴급 상황에서 사용할 **약속 코드**를 미리 설정해야 합니다.

1. 상단 메뉴에서 **설정** 클릭
2. "약속 코드 설정" 섹션에서:
   - **일반 코드**: 긴급 상황 시 검색창에 입력할 문장 (예: "오늘 날씨 좋다")
   - **듀레스 코드**: 강압 상황에서 사용할 별도 문장 (예: "비가 올 것 같아")
   - **보안 질문**: 본인 확인용 질문 (예: "우리 강아지 이름은?")
   - **보안 답변**: 질문의 정답 (예: "초코")
3. **저장** 클릭

> **일반 코드 vs 듀레스 코드**
> - 일반 코드: 평소 긴급 상황에서 사용
> - 듀레스 코드: 가해자가 강제로 코드를 입력하게 하는 경우, 겉보기에는 정상이지만 보호자에게 "강압 상황"임을 알림

### 보호자 초대

1. **설정** 페이지에서 "보호자 관리" 섹션 이동
2. 보호자의 전화번호, 관계, 별칭 입력
3. **초대 보내기** 클릭
4. 생성된 **초대 토큰**을 보호자에게 전달 (메신저, 문자 등)

### 긴급 상황 시 사용법

**이것이 DODAM의 핵심 기능입니다.**

1. 웹 브라우저에서 DODAM 검색 페이지 접속 (`/search`)
   - 화면은 **구글 검색창**처럼 보입니다
   - 네비게이션 바도 표시되지 않습니다
2. 검색창에 **미리 설정한 약속 코드** 입력 (예: "오늘 날씨 좋다")
3. **Google 검색** 버튼 클릭
4. 보안 질문이 표시되면 **정답** 입력 후 확인
5. 긴급 채팅방이 자동 생성됨 (보호자에게 알림 전송)

#### 긴급 채팅 사용법 (검색 위장)

채팅방에 입장하면 화면은 여전히 **검색 결과**처럼 보입니다:

- **내가 보낸 메시지**: 검색어처럼 표시됨
- **보호자 메시지**: 검색 결과 링크처럼 표시됨
- **시스템 메시지**: 검색 정보 패널처럼 표시됨

메시지 전송 방법:
- 검색창에 메시지 입력 후 **Google 검색** 버튼 클릭
- **I'm Feeling Lucky** 버튼 클릭: 미리 정의된 프리셋 메시지 전송
- 하단 푸터의 링크: 빠른 프리셋 메시지 전송 (예: "도움 요청", "안전합니다", "경찰 신고" 등)

#### 프리셋 메시지 목록

| 버튼 | 의미 |
|------|------|
| 도움 요청 | 도움이 필요합니다 |
| 안전합니다 | 현재 안전한 상태입니다 |
| 경찰 신고 | 경찰에 신고해 주세요 |
| 통화 불가 | 전화를 받을 수 없습니다 |
| 돈 요구 중 | 금전을 요구받고 있습니다 |
| 의심 링크 | 의심스러운 링크를 받았습니다 |

> 이 모든 인터페이스는 옆에서 보는 사람에게는 **평범한 구글 검색**으로 보입니다.

---

## 보호자 사용법

### 초대 수락

1. 피해자로부터 받은 **초대 토큰**을 준비
2. 보호자 계정으로 로그인
3. `/guardian/accept` 페이지로 이동 (또는 피해자가 보낸 링크 클릭)
4. 초대 토큰 입력 후 **초대 수락** 클릭
5. 피해자와 연결 완료

### 대시보드

보호자 로그인 후 자동으로 대시보드(`/guardian`)로 이동합니다.

대시보드에서 확인할 수 있는 정보:
- **긴급 채팅방 목록**: 연결된 피해자의 긴급 채팅방
- **듀레스 표시**: 강압 상황으로 생성된 방에는 경고 표시
- **AI 분석 요약**: 대화 내용 기반 위험도 분석
- **위험 신호**: AI가 감지한 주요 위험 키워드
- **행동 가이드**: 상황별 대응 체크리스트

#### AI 분석 기능

- **위험도 레벨**: LOW (낮음) / MEDIUM (중간) / HIGH (높음)
- **분석 요약**: 대화 내용 요약
- **위험 신호**: 피싱, 금전 요구, 위협 등 감지된 키워드
- **행동 가이드**: 경찰 신고, 증거 보존 등 권장 조치

**AI 재분석** 버튼으로 최신 대화 내용을 다시 분석할 수 있습니다.

### 긴급 채팅

1. 대시보드에서 채팅방 클릭
2. 일반 채팅 인터페이스에서 메시지 전송
3. 파일 첨부 가능 (증거 자료 등)
4. 긴급도 평가 가능

---

## 주요 기능 상세

### 데이터 보안

- **약속 코드**: bcrypt 해시 저장 (원문 저장하지 않음)
- **전화번호**: AES-256-GCM 암호화 저장
- **채팅 메시지**: AES-256-GCM 암호화 저장
- **보호자 전화번호**: 피해자 화면에서 노출되지 않음
- **레이트 리밋**: 무차별 대입 공격 방지

### 듀레스 코드

듀레스(강압) 코드는 가해자가 피해자에게 코드 입력을 강요하는 상황을 위해 설계되었습니다.

- 듀레스 코드로 진입하면 겉으로는 일반 채팅방과 동일하게 작동
- 보호자 대시보드에서는 **듀레스 플래그**가 표시되어 강압 상황임을 인지
- 보호자는 이를 바탕으로 적절한 대응 가능 (경찰 신고 등)

### 데이터 삭제

피해자는 설정 페이지에서 **데이터 삭제 요청**을 할 수 있습니다.
삭제 시 관련된 모든 데이터(채팅 기록, 보호자 연결, 코드 설정 등)가 즉시 삭제됩니다.

---

## 자주 묻는 질문

### Q: 약속 코드를 잊어버렸어요.
**A**: 설정 페이지에서 새로운 약속 코드를 다시 설정할 수 있습니다. 기존 코드는 덮어씌워집니다.

### Q: 검색 페이지에서 잘못된 코드를 입력하면?
**A**: 일반 검색 결과가 표시됩니다. 가해자가 보더라도 평범한 검색으로 보입니다.

### Q: 보안 질문에 틀린 답을 입력하면?
**A**: 마찬가지로 일반 검색 결과가 표시됩니다. 시스템의 존재가 노출되지 않습니다.

### Q: 보호자는 어떻게 알림을 받나요?
**A**: 긴급 채팅방이 생성되면 보호자 대시보드에 즉시 표시됩니다. SMS 알림은 별도 설정이 필요합니다.

### Q: 여러 명의 보호자를 등록할 수 있나요?
**A**: 네, 설정 페이지에서 여러 보호자를 초대할 수 있습니다. 긴급 상황 시 모든 연결된 보호자에게 알림이 전송됩니다.

### Q: 채팅 내용은 안전한가요?
**A**: 모든 메시지는 AES-256-GCM으로 암호화되어 저장됩니다. 서버에서도 평문으로 저장되지 않습니다.

### Q: 모바일에서도 사용 가능한가요?
**A**: 네, 반응형 웹으로 제작되어 모바일 브라우저에서도 사용 가능합니다. 앱 설치 없이 웹 브라우저로 접속하면 됩니다.
